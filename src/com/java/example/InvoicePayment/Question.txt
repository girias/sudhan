Invoice Payment System
[Strictly adhere to the object oriented programming specifications given in the problem statement. Template code is provided to ease the input output process. Template code will not compile . You need to fill in the missing code.]

Business Requirement:

Your task is to pay for a particular invoice from a list of invoices.

Select an invoice you need to pay from the list of given invoices and choose the mode of payment (Credit Card/Cheque). Tax is levied on every invoice payment based on the mode, for credit card payments the tax imposed is 10% of the payable amount and for cheque payments, tax payable is Rs. 250. Once the payment is complete,update the balance amount and increase payment attempt count by one. Validate the credit card and cheque details and if all the details are valid, display the total payable amount for the invoice along with the balance amount pending for payment. Handle the exceptions if any entered credit card/cheque details do not comply with the validation rules. Along with this, you also need to streamline to entity / java class structure to align with object oriented programming principles like inheritance ,abstract class, exception and jdbc.

Requirement 1:

Create a class Invoice with the following private attributes

Datatype	Name	Description
Integer	id	Unique Database identifier
String	customerName	Name of the customer
Integer	paymentAttempts	No. of attempts, the customer attempt to pay the invoice amount.
Double	totalAmount	Total invoice amount
Double	balance	Pending invoice amount
String	status	Status of the invoice

Create an abstract class Payment with the following protected attributes

Datatype	Name	Description
String	accountHolderName	The name of the bank account holder.
Double	amount	Amount going to pay.

Create a class ChequePayment which extends Payment with the following private attributes

Datatype	Name	Description
String	bankName	Name of the bank
String	chequeNumber	Unique id of cheque
java.util.Date	chequeDate	Cheque date (dd/MM/yyyy)

Create a class CreditCardPayment which extends Payment with the following private attributes

Datatype	Name	Description
String	cardNumber	Unique identity of card
String	cvv	Cvv number of card
String	cardName	Name of the card

Create a class InvalidPaymentException which extends Exception.

Include appropriate getters,setters and default constructors for all the classes specified above.

Include an abstract method calculateTotalAmount() in the Payment class
    public abstract Double calculateTotalAmount()

The classes ChequePayment and CreditCardPayment should extend the abstract class Payment and these classes have to override all the abstract methods in the Payment class.

Requirement 2:

Create a class InvoiceDAO with the following methods,

No	Class Name	Method Name	Input Parameters	Output Parameters
1	InvoiceDAO	getAllInvoices() -
Fetch details of all the Invoices from invoice table in database and return the list of all the invoices.	-	List<Invoice>
2	InvoiceDAO	updateInvoiceDetails() -
Update the balance amount and increase attempt count by one in the invoice table.	Integer invoiceId, Double balanceAmount	void




Requirement 3:

No	Class Name	Method Name	Input Parameters	Output Parameters
1	ChequePayment	Define calculateTotalAmount() method which returns the total payable amount. Total payable amount is the sum of amount and Rs. 250.	-	Double
2	CreditCardPayment	Define calculateTotalAmount() returns the total payable amount. Total payable amount is the sum of amount and 10% of the amount.	-	Double

Requirement 4:

No	Class Name	Method Name	Input Parameters	Output Parameters
1	ChequePayment	Define calculateTotalAmount()
and validate the cheque details. If the details are invalid then throw InvalidPaymentException with the message “Invalid Cheque Details”.
Validation Rules:
1.    The cheque number should contain only numbers.
2.    Payable amount should not be negative.
Note:
If any one or both the validation rules fails, then throw an exception.	-	Double
2	CreditCardPayment	Define
calculateTotalAmount() -
Validate the card details. If the details are invalid then throw InvalidPaymentException with the message “Invalid Card Details”.
Validation Rules:
1.    The card number should be 16 digits and should contain only numbers.
2.    The cvv should be only 3 digits
Note:
If any one or both the validation rule fails, then throw an exception.	-	Double



Create DbConnection class to include the connection code.

No	Class Name	Method Name	Input Parameters	Output Parameters
1	DbConnection	static getConnection() -
This method is used to connect the java application with mysql database. Here register the JDBC driver for the application,configure the database properties(fetch from mysql.properties) and return the connection object.	-	Connection

mysql.properties :
            db.url=jdbc:mysql://localhost:3306/invoice
            db.username=root
            db.password=

Use the below code to retrieve the connection details from mysql.properties to establish connection
            ResourceBundle rb = ResourceBundle.getBundle("mysql");
            String url = rb.getString("db.url");
            String user = rb.getString("db.username");
            String pass = rb.getString("db.password");

Table Structure:
DBMS create scripts and insert queries are available as part of code template.

//////////////////unable to paste the table structure here/////////////


Input and Output Format :

Input:
First input is an integer that corresponds to the invoice id.
Second input is an integer that corresponds to the choice of payment.
The following inputs corresponds to the payment and credit card/cheque details.

Output:
Invoice details should be of the format:
System.out.format("%-5s %-15s %-20s %-15s %-10s %s\n","ID","Customer Name","Payment Attempts","Total Amount","Balance","Status")
Display the total payable amount and the balance invoice amount still pending for payment.
If the payment details are invalid, display the exception message.
If the choice entered is invalid, display the message “Invalid Input”.

Refer Sample Input and Output for formatting specifications.

[All text in bold corresponds to Input and the rest corresponds to Output.]
Sample Input and Output 1:
Invoice Details:
ID        Customer Name   Payment Attempts       Total Amount            Balance         Status
1          Shravan                    1                                            45000.0                       30000.0          Pending
2          Rafael                        0                                             5000.0                         5000.0            Pending
3          Tori                              1                                             800.0                            200.0              Pending
4          John                           2                                             15000.0                       10000.0          Pending
5          Jack                            0                                             900.0                             900.0              Pending
6          Rosy                            1                                             1000.0                          500.0              Pending
7          Roger                          2                                             3000.0                          2000.0            Pending
8          Steffi                            1                                             1000.0                          500.0              Pending
9          Nadal                          1                                             2000.0                          1000.0            Pending
10        Federer                      0                                             1000.0                          1000.0            Pending
Enter the invoice id to pay :
1
Enter the Payment mode:
1. Credit Card
2. Cheque
Enter your choice :
1
Enter the name :
John Abraham
Enter the amount :
5000
Enter the card number :
9876540194562957
Enter the cvv :
945
Enter the card name :
Visa
Total Amount to be paid is 5500.0
The balance amount is 25000.0

Sample Input and Output 2:

Invoice Details:
ID        Customer Name   Payment Attempts       Total Amount            Balance         Status
1          Shravan                     2                                            45000.0                      25000.0          Pending
2          Rafael                         0                                            5000.0                         5000.0            Pending
3          Tori                               1                                            800.0                            200.0              Pending
4          John                            2                                            15000.0                       10000.0          Pending
5          Jack                             0                                            900.0                            900.0              Pending
6          Rosy                            1                                             1000.0                         500.0              Pending
7          Roger                          2                                             3000.0                         2000.0            Pending
8          Steffi                            1                                             1000.0                         500.0              Pending
9          Nadal                          1                                              2000.0                        1000.0            Pending
10        Federer                      0                                             1000.0                         1000.0            Pending
Enter the invoice id to pay :
4
Enter the Payment mode:
1. Credit Card
2. Cheque
Enter your choice :
2
Enter the name :
James victor
Enter the amount :
3000
Enter the bank name :
ICICI bank
Enter the cheque number :
846516854654
Enter the cheque date :
12/10/2017
Total Amount to be paid is 3250.0
The balance amount is 7000.0

Sample Input and Output 3:

Invoice Details:
ID        Customer Name   Payment Attempts       Total Amount            Balance         Status
1          Shravan                     2                                           45000.0                       25000.0          Pending
2          Rafael                         0                                           5000.0                          5000.0            Pending
3          Tori                               1                                           800.0                             200.0             Pending
4          John                            3                                            15000.0                       7000.0            Pending
5          Jack                            0                                            900.0                             900.0              Pending
6          Rosy                            1                                            1000.0                          500.0              Pending
7          Roger                          2                                           3000.0                           2000.0            Pending
8          Steffi                            1                                           1000.0                           500.0             Pending
9          Nadal                          1                                           2000.0                           1000.0            Pending
10        Federer                      0                                          1000.0                            1000.0            Pending
Enter the invoice id to pay :
7
Enter the Payment mode:
1. Credit Card
2. Cheque
Enter your choice :
1
Enter the name :
Kate Winslet
Enter the amount :
1000
Enter the card number :
948365928467498
Enter the cvv :
154
Enter the card name :
Mastero
InvalidPaymentException: Invalid Card Details

Sample Input and Output 4:

Invoice Details:
ID        Customer Name   Payment Attempts       Total Amount            Balance         Status
1          Shravan                    2                                            45000.0                       25000.0          Pending
2          Rafael                        0                                             5000.0                         5000.0            Pending
3          Tori                              1                                             800.0                            200.0              Pending
4          John                            3                                             15000.0                      7000.0            Pending
5          Jack                            0                                             900.0                            900.0              Pending
6          Rosy                            1                                             1000.0                          500.0              Pending
7          Roger                          2                                              3000.0                        2000.0            Pending
8          Steffi                           1                                              1000.0                         500.0              Pending
9          Nadal                         1                                               2000.0                       1000.0            Pending
10        Federer                     0                                              1000.0                        1000.0            Pending
Enter the invoice id to pay :
5
Enter the Payment mode:
1. Credit Card
2. Cheque
Enter your choice :
2
Enter the name :
Rose
Enter the amount :
400
Enter the bank name :
Yes bank
Enter the cheque number :
1684564FDS16514
Enter the cheque date :
10/11/2017
InvalidPaymentException: Invalid Cheque Details

Sample Input and Output 5:
Invoice Details:
ID        Customer Name   Payment Attempts       Total Amount            Balance         Status
1          Shravan                     2                                           45000.0                        25000.0          Pending
2          Rafael                         0                                            5000.0                          5000.0            Pending
3          Tori                               1                                            800.0                             200.0              Pending
4          John                            3                                            15000.0                        7000.0            Pending
5          Jack                            0                                             900.0                            900.0              Pending
6          Rosy                            1                                             1000.0                          500.0              Pending
7          Roger                          2                                             3000.0                         2000.0            Pending
8          Steffi                            1                                            1000.0                          500.0              Pending
9          Nadal                          1                                             2000.0                         1000.0            Pending
10        Federer                      0                                            1000.0                         1000.0            Pending
Enter the invoice id to pay :
4
Enter the Payment mode:
1. Credit Card
2. Cheque
Enter your choice :
3
Invalid Input


